<!DOCTYPE html>
<html lang="en">
<head>
<title>Project 4: (Auto)stitching and photo mosaics</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<style>
body,h1,h2,h3,h4,h5 {font-family: "Poppins", sans-serif}
body {font-size:16px;}
.w3-half img{margin-bottom:-6px;margin-top:16px;cursor:pointer}
.w3-half img:hover{opacity:0.8}
.w3-quarter img{margin-bottom:-6px;margin-top:16px;cursor:pointer}
.w3-quarter img:hover{opacity:0.8}
.w3-third img{margin-bottom:-6px;margin-top:16px;cursor:pointer}
.w3-third img:hover{opacity:0.8}
.header {
    text-align: center;
    font-size: 20px;
    margin-top: 15px;
    font-weight: 100;
}.caption {
    text-align: center;
    font-size: 16px;
    margin-top: 15px;
}
.equation {
    font-size: 1.5em;
    margin: 10px 0;
}
.matrix {
    display: inline-block;
    border: 1px solid #ccc;
    padding: 10px;
    margin-right: 10px;
}

</style>
</head>
<body>

<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-blue-gray w3-collapse w3-top w3-large w3-padding" style="z-index:3;width:300px;font-weight:bold;" id="mySidebar"><br>
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-button w3-hide-large w3-display-topleft" style="width:100%;font-size:22px">Close Menu</a>
  <div class="w3-container">
    <h3 class="w3-padding-64"><b>Kelly Yeh<br>(SID: 3037233460)</b></h3>
  </div>
  <div class="w3-bar-block">
    <a href="#" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Home</a> 
    <a href="#Part5A" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Part 5A</a>
    <a href="#Part0" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">0: Setup</a>
    <a href="#Part1.1" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.1: Implementing the Forward Process</a> 
    <a href="#Part1.2" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.2: Classical Denoising</a> 
    <a href="#Part1.3" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.3: One-Step Denoising</a> 
    <a href="#Part1.4" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.4: Iterative Denoising</a> 
    <a href="#Part1.5" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.5: Diffusion Model Sampling</a>
    <a href="#Part1.6" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.6: Classifier-Free Guidance</a>
    <a href="#Part1.7" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.7: Image-to-Image Translation</a> 
    <a href="#Part1.7.1" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.7.1: Editing Hand-Drawn and Web Images</a> 
    <a href="#Part1.7.2" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.7.2 Inpainting</a> 
    <a href="#Part1.7.3" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.7.3 Text-Conditional Image-to-image Translation</a> 
    <a href="#Part1.8" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.8 Visual Anagrams</a>
    <a href="#Part1.9" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1.9 Hybrid Images</a>
    <a href="#Part5B" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Part 5B</a>
    <a href="#Part1" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1: Training a Single-Step Denoising UNet</a> 
    <a href="#Part2" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">2: Training a Diffusion Model</a> 
  </div>
</nav>

<!-- Top menu on small screens -->
<!-- <header class="w3-container w3-top w3-hide-large w3-blue-gray w3-xlarge w3-padding">
  <a href="javascript:void(0)" class="w3-button w3-blue-gray w3-margin-right" onclick="w3_open()">☰</a>
  <span>Kelly Yeh (3037233460)</span>
</header> -->

<!-- Overlay effect when opening sidebar on small screens -->
<!-- <div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div> -->

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:340px;margin-right:40px">
  
    <!-- Header -->
    <div class="w3-container" style="margin-top:80px" id="Part4A">
        <h1 class="w3-jumbo"><b>Project 5: Fun With Diffusion Models!</b></h1>
        <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Part 5A</b></h1>
    </div>

    <!-- Part 0 -->
    <div class="w3-container" id="Part0" style="margin-top:45px">
        <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Part 0: Setup</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-container">
            <p><b></b>
                The random seed I used was 180. By providng text prompts and sampling from the model, 
                I generated an image of an oil painting of a snow mountain village, a man wearing a hat, 
                and a rocket ship using num_inference_steps = 20 and num_inference_steps = 70.
            </b></p>   
        </div>
        <div class="header"><b></b>
            num_inference_steps = 20
        </b></div>  
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/0-1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-third">
                <img src="./media/0-2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-third">
                <img src="./media/0-3.png" style="width:100%" onclick="onClick(this)">
            </div>
        </div>
        <div class="header"><b></b>
            num_inference_steps = 70
        </b></div>  
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/0-4.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-third">
                <img src="./media/0-5.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-third">
                <img src="./media/0-6.png" style="width:100%" onclick="onClick(this)">
            </div>
        </div>
    </div>
    
    <!-- Part 1.1 -->
    <div class="w3-container" id="Part1.1" style="margin-top:45px">
        <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Part 1: Sampling Loops</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.1: Forwarding Process</b></h1>
        <div class="w3-container">
            <p><b></b>
                I added noise to an image via a forward process using equation 2.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-quarter">
                <img src="./media/test-im.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/1.1-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 250</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/1.1-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 500</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/1.1-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 750</div>
            </div>
        </div>
    </div>
    
    <!-- Part 1.2 -->
    <div class="w3-container" id="Part1.2" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.2: Classical Denoising</b></h1>
        <div class="w3-container">
            <p><b></b>
                I used the Gaussian blur filter to remove the noise from the noisy images 
                generated in part 1.1.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/1.1-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 250</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.1-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 500</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.1-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 750</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/1.2-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Blurred t = 250</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.2-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Blurred t = 500</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.2-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Blurred t = 750</div>
            </div>
        </div>
    </div>

    <!-- Part 1.3 -->
    <div class="w3-container" id="Part1.3" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.3: One-Step Denoising</b></h1>
        <div class="w3-container">
            <p><b></b>
                Using the Unet, I estimate the noise by passing it through stage_1.unet 
                and then subsequently remove this noise to estimate the original image in 
                one step.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/1.3-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 250</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.3-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 500</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.3-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 750</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/1.3-4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">One-Step Denoised t = 250</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.3-5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">One-Step Denoised t = 500</div>
            </div>
            <div class="w3-third">
                <img src="./media/1.3-6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">One-Step Denoised t = 750</div>
            </div>
        </div>
    </div>

    <!-- Part 1.4 -->
    <div class="w3-container" id="Part1.4" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.4: Iterative Denoising</b></h1>
        <div class="w3-container">
            <p><b></b>
                Rather than denoising in one step, I denoise starting from an i_start of 10 and iteratively across strided_timesteps 
                starting at 990 and reducing by a stride of 30. Then I denoise using equation 3 every iteration.
            </b></p>   
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.4-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 90</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.4-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 240</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.4-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 390</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.4-4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 540</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.4-5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">t = 690</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-quarter">
                <img src="./media/test-im.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/1.4-iteratively-denoised.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Iteratively Denoised</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/1.3-6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">One-Step Denoised</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/1.2-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Gaussian Blurred</div>
            </div>
        </div>
    </div>

    <!-- Part 1.5 -->
    <div class="w3-container" id="Part1.5" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.5: Diffusion Model Sampling</b></h1>
        <div class="w3-container">
            <p><b></b>
                To generate images from scratch, I utilize an i_start of 0 and pass in random noise to 
                generate 5 high quality photos.
            </b></p>   
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.5-1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.5-2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.5-3.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.5-4.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.5-5.png" style="width:100%" onclick="onClick(this)">
            </div>
        </div>
    </div>

    <!-- Part 1.6 -->
    <div class="w3-container" id="Part1.6" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.6: Classifier Free Guidance</b></h1>
        <div class="w3-container">
            <p><b></b>
                To improve image quality, we can employ classifier free guidance. This is done by 
                computing both a conditional (condition on the text prompt) and an unconditional noise estimate
                (condition on null text prompt), and aggregating a new estimate from these two estimates that 
                are scaled using a scale value of 7. These are the resulting high quality photos. 
            </b></p>   
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.6-1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.6-2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.6-3.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.6-4.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-col s2">
                <img src="./media/1.6-5.png" style="width:100%" onclick="onClick(this)">
            </div>
        </div>
    </div>

    <!-- Part 1.7 -->
    <div class="w3-container" id="Part1.7" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.7: Image-To-Image Translation</b></h1>
        <div class="w3-container">
            <p><b></b>
                Here, we'll follow the SDEdit algorithm to make a series of edits that become 
                more and more like our image using different starting indexes of 1, 3, 5, 7, 10, and 20.
            </b></p>   
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.7-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7-4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7-5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7-6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test-im.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/sdeedit_lake_1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lake_3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lake_5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lake_7.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lake_10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lake_20.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/crater_lake.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Crater Lake</div>
            </div>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/sdeedit_lantern_1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lantern_3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lantern_5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lantern_7.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lantern_10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/sdeedit_lantern_20.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Lantern</div>
            </div>
        </div>
    </div>

    <!-- Part 1.7.1 -->
    <div class="w3-container" id="Part1.7.1" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.7.1: Editing Hand-Drawn and Web Images</b></h1>
        <div class="w3-container">
            <p><b></b>
                Here, we're repeating the same SDEdit algorithm on images from the internet and handdrawn images.
            </b></p>   
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.7.1-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/internet.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Image from Internet</div>
            </div>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.7.1-1-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-1-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-1-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-1-4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-1-5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-1-6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/handdrawn1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Handdrawn Image 1</div>
            </div>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/1.7.1-2-1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-2-2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-2-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-2-4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-2-5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/1.7.1-2-6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">i_start = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/handdrawn2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Handdrawn Image 2</div>
            </div>
        </div>
    </div>

    <!-- Part 1.7.2 -->
    <div class="w3-container" id="Part1.7.2" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.7.2: Inpainting</b></h1>
        <div class="w3-container">
            <p><b></b>
                Now, we want to isolate image generation and only run the diffusion denoising loop to within the bounds of a binary mask. 
                Hence, I went ahead and created masks for my test, crater lake, and lantern images and impainted them.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-quarter">
                <img src="./media/test-im.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/test_im_mask.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Mask</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/test_im_to_replace.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Hole to Replace</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/test_im_impainted.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Impainted</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-quarter">
                <img src="./media/crater_lake.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Crater Lake</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/crater_lake_mask.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Mask</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/crater_lake_to_replace.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Hole to Replace</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/crater_lake_impainted.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Impainted</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-quarter">
                <img src="./media/lantern.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Lantern</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/lantern_mask.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Mask</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/lantern_to_replace.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Hole to Replace</div>
            </div>
            <div class="w3-quarter">
                <img src="./media/lantern_impainted2.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Impainted</div>
            </div>
        </div>
    </div>

    <!-- Part 1.7.3 -->
    <div class="w3-container" id="Part1.7.3" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.7.3: Text-Conditioned Image-to-image Translation</b></h1>
        <div class="w3-container">
            <p><b></b>
                Now, we're repeating the same SDEdit algorithm but using a text prompt. Using "a rocket ship" as our text prompt, 
                this will transform our images more and more to look like a rocket ship.
            </b></p>   
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/test_rocket1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test_rocket3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test_rocket5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test_rocket7.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test_rocket10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test_rocket20.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/test-im.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/lake_rocket1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lake_rocket3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lake_rocket5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lake_rocket7.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lake_rocket10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lake_rocket20.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/crater_lake.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center; gap: 16px;">
            <div class="w3-col s2">
                <img src="./media/lantern_rocket1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 1</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern_rocket3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 3</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern_rocket5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 5</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern_rocket7.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 7</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern_rocket10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 10</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern_rocket20.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Noise level = 20</div>
            </div>
            <div class="w3-col s2">
                <img src="./media/lantern.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Test Image</div>
            </div>
        </div>
    </div>

    <!-- Part 1.8 -->
    <div class="w3-container" id="Part1.8" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.8: Visual Anagrams</b></h1>
        <div class="w3-container">
            <p><b></b>
                Next, we want to create visual anagrams, which are images like look like one thing rightside up and 
                look like something else upside down. To do this, we pass in two separate prompts, and denoise with each 
                prompt. For the first prompt, we denoise as usual. For the second prompt, we flip the image upside first, 
                compute the noise estimate, and then our noise estimate back to rightside up. We perform the reverse diffusion 
                step using the average of these two noise estimates.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/campire_old_man_anagram.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">An Oil painting of an Old Man</div>
            </div>
            <div class="w3-half">
                <img src="./media/flipped_campire_old_man_anagram.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">An Oil Painting of People around a Campfire</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/panda_snowy_mountain_anagram.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">An Oil painting of an Panda</div>
            </div>
            <div class="w3-half">
                <img src="./media/flipped_panda_snowy_mountain_anagram.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">An Oil painting of a Snowy Mountain</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/skull_waterfall_anagram.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">A Lithograph of a Waterfall</div>
            </div>
            <div class="w3-half">
                <img src="./media/flipped_skull_waterfall_anagram.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">A Lithograph of a Skull</div>
            </div>
        </div>
    </div>

    <!-- Part 1.9 -->
    <div class="w3-container" id="Part1.9" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1.9: Hybrid Images</b></h1>
        <div class="w3-container">
            <p><b></b>
                To create hybrid images we still use two separate prompts and generate noise estimates from them. Rather 
                than flipped as in part 1.8, we run the first noise estimate through a low pass filter using a Gaussian kernel 
                and the second noise estimate through a high pass filter (original - low pass). The combined low pass and high pass 
                noise estimates are then used for the diffusion step.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/hybrid_skull_waterfall.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Hybrid Image of a Skull and Waterfall</div>
            </div>
            <div class="w3-third">
                <img src="./media/hybrid_mountains_bird.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Hybrid Image of a White Bird and a Snowy Mountain</div>
            </div>
            <div class="w3-third">
                <img src="./media/hybrid_panda_campfire.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Hybrid Image of a Panda and People around a Campfire</div>
            </div>
        </div>
    </div>

    <div class="w3-container" style="margin-top:80px" id="Part5B">
        <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Part 5B</b></h1>
    </div>

    <!-- Part 1 -->
    <div class="w3-container" id="Part1" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>1: Implementing the UNet</b></h1>
        <div class="w3-container">
            <p><b></b>
                I constructing a denoiser as a UNEt by implementing its inner convolutional and average 
                pooling layers and upscaling/downscaling/concatenating them as needed. I generated noisy images
                via z = x + sigma * epsilon and applied the denoiser to denoise the noisy images at varying sigma values. 
                The result is shown in the figure below.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure3.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 3: Varying Levels of Noise on MNIST Digits</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                Then, I trained this denoiser optimized over L2 loss on the MNIST dataset.
            </b></p>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure4.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 4: Training Loss Curve</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                These are the denoised results on the test set after training on one epoch.
            </b></p>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure5.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 5: Denoised Images After One Epoch of Training</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                These are the denoised results on the test set after training on five epochs. 
                As you can see, it performs better than one epoch.
            </b></p>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure6.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 6: Denoised Images After Five Epochs of Training</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                Here is a visualization of denoising on varying levels of sigma.
            </b></p>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure7.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 7: Results on Digits from Test Set with Varying Noise Levels</div>
        </div>
    </div>

    <!-- Part 2 -->
    <div class="w3-container" id="Part2" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>2: Training a Diffusion Model</b></h1>
        <div class="w3-container">
            <p><b></b>
                Next, I created a time-conditioned UNet that can iteratively denoise an image via DDPM. 
                This is the loss associated with training 20 epochs on our new time-conditioned UNet.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure10.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 10: Time-Conditioned UNet Training Loss Curve</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                These are the sampled results from the time-conditioned UNet for 5 and 20 epochs respectively.
            </b></p>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/2.3-epoch5.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Epoch 5 Time-Conditioned Sampling</div>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/2.3-epoch20.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Epoch 20 Time-Conditioned Sampling</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                I also created a class-conditioned UNet that can iteratively denoise an image via DDPM 
                with and without conditions
                This is the loss associated with training 20 epochs on our new time-conditioned UNet.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/figure11.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Figure 11: Class-Conditioned UNet Training Loss Curve</div>
        </div>
        <div class="w3-container">
            <p><b></b>
                And these are the sampled results from the class-conditioned UNet for 5 and 20 epochs respectively.
            </b></p>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/2.3-epoch5.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Epoch 5 Class-Conditioned Sampling</div>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/2.3-epoch20.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Epoch 20 Class-Conditioned Sampling</div>
        </div>
    </div>

  <!-- Bells & Whistles -->
  <!-- <div class="w3-container" id="B&W" style="margin-top:75px">
    <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Bells & Whistles</b></h1>
    <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
    <div class="w3-container"style="margin-top:25px" >
        <p><b></b>
            My friends and I created a face-morphing music video together (featuring Jaewon Lee, 
            Rohan Gulati, Victor Zhou, Natalie Wei, and Jennifer Yin). We made sure all our images were 
            500 x 500 pixels and performed the same face morphing. However, we only labeled corresponding 
            points just around the face and not the corners, hence leading to a black background.
            <br>
            <a href="https://www.youtube.com/shorts/YnXyHEYWaT4" target="_blank">Music Video</a>
        </b></p>
    </div>
    <iframe width="315" height="560"
    src="https://www.youtube.com/embed/YnXyHEYWaT4"
    title="YouTube video player"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    allowfullscreen></iframe>
  </div> -->

  <!-- Modal for full size images on click-->
  <div id="modal01" class="w3-modal w3-black" style="padding-top:0" onclick="this.style.display='none'">
    <span class="w3-button w3-black w3-xxlarge w3-display-topright">×</span>
    <div class="w3-modal-content w3-animate-zoom w3-center w3-transparent w3-padding-64">
      <img id="img01" class="w3-image">
      <p id="caption"></p>
    </div>
  </div>

<!-- End page content -->
</div>

<!-- W3.CSS Container -->
<div class="w3-light-grey w3-container w3-padding-32" style="margin-top:75px;padding-right:58px"><p class="w3-right">Website Template: <a href="https://www.w3schools.com/w3css/tryw3css_templates_interior_design.htm#services" title="W3.CSS" target="_blank" class="w3-hover-opacity">w3.css</a></p></div>

<script>
// Script to open and close sidebar
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}
 
function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}

// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}
</script>

</body>
</html>
