<!DOCTYPE html>
<html lang="en">
<head>
<title>Project 6: Final Project</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<style>
body,h1,h2,h3,h4,h5 {font-family: "Poppins", sans-serif}
body {font-size:16px;}
.w3-half img{margin-bottom:-6px;margin-top:16px;cursor:pointer}
.w3-half img:hover{opacity:0.8}
.w3-quarter img{margin-bottom:-6px;margin-top:16px;cursor:pointer}
.w3-quarter img:hover{opacity:0.8}
.w3-third img{margin-bottom:-6px;margin-top:16px;cursor:pointer}
.w3-third img:hover{opacity:0.8}
.header {
    text-align: center;
    font-size: 20px;
    margin-top: 15px;
    font-weight: 100;
}.caption {
    text-align: center;
    font-size: 16px;
    margin-top: 15px;
}
.equation {
    font-size: 1.5em;
    margin: 10px 0;
}
.matrix {
    display: inline-block;
    border: 1px solid #ccc;
    padding: 10px;
    margin-right: 10px;
}

</style>
</head>
<body>

<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-blue-gray w3-collapse w3-top w3-large w3-padding" style="z-index:3;width:300px;font-weight:bold;" id="mySidebar"><br>
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-button w3-hide-large w3-display-topleft" style="width:100%;font-size:22px">Close Menu</a>
  <div class="w3-container">
    <h3 class="w3-padding-64"><b>Kelly Yeh<br>(SID: 3037233460)</b></h3>
  </div>
  <div class="w3-bar-block">
    <a href="#" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Home</a> 
    <a href="#GradientDomain" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Precanned 1: Gradient Domain</a> 
    <a href="#Part2.1" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">2.1: Toy Problem</a>
    <a href="#Part2.2" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">2.2: Poisson Blending</a> 
    <a href="#B&W1" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">B&W: Mixed Gradients</a>
    <a href="#B&W2" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">B&W: Color2Gray</a>
    <a href="#Lightfield" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Precanned 2: Lightfield Camera</a> 
    <a href="#Part1" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">1: Depth Refocusing</a> 
    <a href="#Part2" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">2: Aperture Adjustment</a> 
    <a href="#Summary" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Summary</a> 
    <a href="#B&W3" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">B&W: Interactive Refocusing</a>
    <a href="#NeRF" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">B&W: NeRF Part 1</a>
  </div>
</nav>

<!-- Top menu on small screens -->
<!-- <header class="w3-container w3-top w3-hide-large w3-blue-gray w3-xlarge w3-padding">
  <a href="javascript:void(0)" class="w3-button w3-blue-gray w3-margin-right" onclick="w3_open()">☰</a>
  <span>Kelly Yeh (3037233460)</span>
</header> -->

<!-- Overlay effect when opening sidebar on small screens -->
<!-- <div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div> -->

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:340px;margin-right:40px">
  
    <!-- Header -->
    <div class="w3-container" style="margin-top:80px" id="GradientDomain">
        <h1 class="w3-jumbo"><b>Project 6: Final Project</b></h1>
        <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Precanned 1: Gradient Domain</b></h1>
    </div>

    <!-- Part 2.1 -->
    <div class="w3-container" id="Part2.1" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Part 2.1: Toy Problem</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-container">
            <p><b></b>
                For the toy problem, we will reconstruct the toy image using its gradients and pixel intensities. 
                Essentially, there are 3 objectives we are trying to fulfill:
                <ol>
                    <li>minimize ( v(x+1,y)-v(x,y) - (s(x+1,y)-s(x,y)) )^2</li>
                    <li>minimize ( v(x,y+1)-v(x,y) - (s(x,y+1)-s(x,y)) )^2</li>
                    <li>minimize (v(1,1)-s(1,1))^2</li>
                </ol>
                The first objective computes x gradients between the values of the image v(x+1,y)-v(x,y) and the x 
                gradients between the values of the source image s(x+1,y)-s(x,y). Our goal is to have our source and 
                reconstructed images be as similar as possible, hence we minimize the difference between these gradients. 
                Analogously, the second objective function does the same but minimizes the difference in y gradients. 
                The last objective function serves to ensure that the top left corners of the two images are the same color. 
                Finally, we solve this optimization as a least squares problem to recontruct our original image. The two 
                images are very similar, but slightly vary with a MSE of 0.0010002051356621244.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/toy_original.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Toy Image</div>
            </div>
            <div class="w3-half">
                <img src="./media/toy_reconstructed.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Toy Image</div>
            </div>
        </div>
    </div>

    <!-- Part 2.2 -->
    <div class="w3-container" id="Part2.2" style="margin-top:45px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Part 2.2: Poisson Blending</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-container">
            <p><b></b>
                In poisson blending, the goal is to take a cutout of some source image and seamlessly paste it into a 
                target image, blending the edges and ensuring similar gradients. To do this, we want to fulfill the following 
                constraint below. Let S be the cutout region of our source image (in the dimensions of the target image) and let 
                N be the four neighbors below, above, right, and left of the current pixel i.
            </b></p>
        </div>
        <div class="w3-container" id="contact" style="display: flex; justify-content: center;">
            <img src="./media/poissonblend_eq.png" style="width:100%" onclick="onClick(this)">
        </div>
        <div class="w3-container">
            <p><b></b>
                Algorithmically, we are looping through our pixels and computing their pixel values depending on which case they 
                fall under. Pixels will either:
                <ol>
                    <li>Reside outside of S</li>
                    <li>Reside inside of S, and its neighbor also resides inside of S</li>
                    <li>Reside inside of S, but its neighbor resides outside of S</li>
                </ol>
                In the first case for all pixels outside of S, we will simply copy over the values from our target image into our reconstructed 
                image because there is no blending or overlay done here.
                <br>
                <br>
                For the second and third cases when we are looping over pixels that are in S, we want to check if its neighbors are also in S or not. 
                If the neighbors are also in S, this alludes to the first half of the above constraint, which minimizes the difference 
                between the values of this equation: v(x,y)-v(x_n,y_n) = s(x,y)-s(x_n,y_n). For the second half of the above constraint, we are dealing with 
                pixels that are in S but its neighbors are outside of S, we directly use the target intensity of our neighbor (t_j) in our computation to 
                minimize the values of this equation: v(x,y)-t(x_n,y_n) = s(x,y)-s(x_n,y_n).
                <br>
                <br>
                Then, we solve this least squares problems where A is a matrix of (h * w, h * w) and b is a vector of length h * w. We do this for each of 
                the rgb channels individually and then combining them together, we have a seamless poisson blended result.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/penguin copy.jpg" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Penguin Image</div>
            </div>
            <div class="w3-third">
                <img src="./media/penguin_mask_adult.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Penguin Mask</div>
            </div>
            <div class="w3-third">
                <img src="./media/im3 copy.jpg" style="width:100%" onclick="onClick(this)">
                <div class="caption">Background Ski Image</div>
                </div>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/poisson_penguin.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Blended Image</div>
        </div>
        <div class="w3-container" style="margin-top:45px">
            <p><b></b>
                Each blended image also requires an offset variable bg_ul that we use to decide where in 
                the background the object will be placed. The penguin I placed at (700, 400), the fish at (200, 200), 
                and the plane at (250, 350). I noticed that my blends performed better when the background 
                color matched the object itself. I also used more precise masks with a smaller border around the outside, and 
                this resulted in darker outputs because there was less of the background in my masked image. But overall, the blends worked very well. 
                Here are two more examples of poisson blending:
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-third">
                <img src="./media/fish copy.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Fish Image</div>
            </div>
            <div class="w3-third">
                <img src="./media/fish_mask copy.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Fish Mask</div>
            </div>
            <div class="w3-third">
                <img src="./media/sea copy.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Background Sea Image</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/poisson_fish.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Blended Image</div>
        </div>
        <div class="w3-container" id="contact" style="margin-top:45px">
            <div class="w3-third">
                <img src="./media/plane copy.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Plane Image</div>
            </div>
            <div class="w3-third">
                <img src="./media/plane_mask copy.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Plane Mask</div>
            </div>
            <div class="w3-third">
                <img src="./media/sky1.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Background Sky Image</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <img src="./media/poisson_plane.png" style="width:100%" onclick="onClick(this)">
            <div class="caption">Blended Image</div>
        </div>
    </div>

    <!-- Bells & Whistles -->
    <div class="w3-container" id="B&W1" style="margin-top:75px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Bells & Whistles: Mixed Gradients</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-row-padding">
            <div class="w3-container">
                <p><b></b>
                    For mixed gradients, we want to similarly perform poisson blending but with a modified constraint equation:
                </b></p>   
            </div>
            <div class="w3-container" id="contact" style="display: flex; justify-content: center;">
                <img src="./media/textureblend_eq.png" style="width:100%" onclick="onClick(this)">
            </div>    
            <div class="w3-container">
                <p><b></b>
                    In this case, we are mixing the gradients between the source and target images. To do this, we can take the 
                    absolute value of the source gradients, compare them against the absolute value of the target gradients, and 
                    take the larger of the two. In the above equation, d_ij corresponds to the larger gradient. Below are our results 
                    using mixed gradients compared to regular poisson blending. As you can see, the results tend to more closely 
                    match the background and hence are a little lighter.
                </b></p>   
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-half">
                    <img src="./media/poisson_penguin.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Poisson Penguin</div>
                </div>
                <div class="w3-half">
                    <img src="./media/mixed_penguin.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Mixed Gradients Penguin</div>
                </div>
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-half">
                    <img src="./media/poisson_fish.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Poisson Fish</div>
                </div>
                <div class="w3-half">
                    <img src="./media/mixed_fish.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Mixed Gradients Fish</div>
                </div>
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-half">
                    <img src="./media/poisson_plane.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Poisson Plane</div>
                </div>
                <div class="w3-half">
                    <img src="./media/mixed_plane.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Mixed Gradients Plane</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bells & Whistles -->
    <div class="w3-container" id="B&W2" style="margin-top:75px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Bells & Whistles: Color2Gray</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-row-padding">
            <div class="w3-container">
                <p><b></b>
                    Normally when reconstructing an image, we convert it from color to grayscale using 
                    cv2.cvtColor(image, cv2.COLOR_BGR2GRAY). However, for images such as color blindness 
                    tests, converting these images to grayscale will cause them to lose their contrast and 
                    information.
                </b></p>   
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-half">
                    <img src="./media/color.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Color Image</div>
                </div>
                <div class="w3-half">
                    <img src="./media/color2gray.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Color to Gray Image</div>
                </div>
            </div>
            <div class="w3-container">
                <p><b></b>
                    To resolve this, we can try converting the image to the HSV space:
                </b></p>   
            </div>
            <div class="w3-container" id="contact" style="display: flex; justify-content: center;">
                <img src="./media/hsv.png" style="width:100%" onclick="onClick(this)">
            </div>    
            <div class="w3-container">
                <p><b></b>
                    By using the V channel, which still preserves the information and intensities from the original image 
                    and properly converts it to grayscale, we're able to reconstruct the image properly with 
                    a MSE of 4.882742657242126e-13.
                </b></p>   
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-third">
                    <img src="./media/color.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Original Color Image</div>
                </div>
                <div class="w3-third">
                    <img src="./media/color2gray.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Color to Gray Image</div>
                </div>
                <div class="w3-third">
                    <img src="./media/reconstructed_gray.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Reconstructed Gray Image</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Part 1 -->
    <div class="w3-container" style="margin-top:45px" id="Lightfield">
        <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Precanned 2: Lightfield Camera</b></h1>
        <h1 class="w3-xxlarge w3-text-blue-gray" id="Part1"><b>Part 1: Depth Refocusing</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-container">
            <p><b></b>
                Using a series of rectified images of a chess board, a regularly spaced grid, I can 
                refocus the depth of the image by reshifting. Typically, just averaging together all 
                the images in the grid will cause blurriness in the front and sharpness in the back due 
                to the large positional differences of nearby objects as opposed to faraway objects. 
                However, we're able to specify areas of sharpness by shifting the images using np.roll 
                appropriately. By using different depth_factor values, we're able to choose how close to 
                the camera the sharpness is.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/refocused_depth_0.0.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">depth_factor = 0.0</div>
            </div>
            <div class="w3-half">
                <img src="./media/refocused_depth_1.0.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">depth_factor = 1.0</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/refocused_depth_2.0.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">depth_factor = 2.0</div>
            </div>
            <div class="w3-half">
                <img src="./media/refocused_depth_3.0.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">depth_factor = 3.0</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div style="margin-top: 30px; display: flex; justify-content: space-around; align-items: stretch;">
                <img src="./media/depth.gif" style="height: 300px; width: auto; max-width: 100%;">
            </div>
        </div>
    </div>

    <!-- Part 2 -->
    <div class="w3-container" id="Part2" style="margin-top:75px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Part 2: Aperture Adjustment</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-container">
            <p><b></b>
                We're able to mimic variations in aperture by averaging over a different number of images. 
                Modifying my refocus function by introducing an aperture parameter, I choose a smaller 
                subset of images close to the center for a smaller aperture that still focuses on the same point, 
                and vice versa. The results are shown below.
            </b></p>   
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/refocused_aperture_0.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">aperture = 0</div>
            </div>
            <div class="w3-half">
                <img src="./media/refocused_aperture_3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">aperture = 3</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/refocused_aperture_6.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">aperture = 6</div>
            </div>
            <div class="w3-half">
                <img src="./media/refocused_aperture_9.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">aperture = 9</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div style="margin-top: 30px; display: flex; justify-content: space-around; align-items: stretch;">
                <img src="./media/aperture.gif" style="height: 300px; width: auto; max-width: 100%;">
            </div>
        </div>
    </div>

    <!-- Part Summary -->
    <div class="w3-container" id="Summary" style="margin-top:75px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Summary</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-container">
            <p><b></b>
                I am fascinated by how, just using images of a regularly spaced grid, we are able to change the visualization 
                of the object in ways analogous to settings on a camera, including depth and aperture. These refocusing techniques 
                only required averaging and shifting various images together and demonstrates how powerful lightfield data is.
            </b></p>   
        </div>
    </div>
    
    <!-- Bells & Whistles -->
    <div class="w3-container" id="B&W3" style="margin-top:75px">
        <h1 class="w3-xxlarge w3-text-blue-gray"><b>Bells & Whistles: Interactive Refocusing</b></h1>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <div class="w3-row-padding">
            <div class="w3-container">
                <p><b></b>
                    For interactive refocusing, we want to grant the user the ability to select an input point and make optimal pixel 
                    shifts such that the image is focused in a patch around the selected point. We can select for the point using plt.ginput. 
                    By selecting for a reasonable aperture, we optimize shifts for the depth_factor. Each selected point is displayed in red 
                    and the refocused results are shown below.
                </b></p>   
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-third">
                    <img src="./media/interactive1.png" style="width:100%" onclick="onClick(this)">
                </div>
                <div class="w3-third">
                    <img src="./media/interactive2.png" style="width:100%" onclick="onClick(this)">
                </div>
                <div class="w3-third">
                    <img src="./media/interactive3.png" style="width:100%" onclick="onClick(this)">
                </div>
            </div>
        </div>
    </div>

  <!-- NeRF Part 1 -->
  <div class="w3-container" id="NeRF" style="margin-top:75px">
    <h1 class="w3-xxxlarge w3-text-blue-gray"><b>Bells & Whistles: NeRF Part 1</b></h1>
    <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
    <div class="w3-container"style="margin-top:25px" >
        <div class="w3-third">
            <img src="./media/fox.jpg" style="width:100%" onclick="onClick(this)" alt="Cameraman.png">
        </div>
        <div class="w3-rest">
            <div class="w3-container">
                <p><b></b>
                    Neural radiance fields (NeRF) are used to map {x, y, z, θ, φ} to {r, g, b, σ}, or in other words, maps 
                    positionality and direction to color. In 2D, however, we map pixel coordinates (u, v) to {r, g, b} values. 
                    Here is an image of a fox we will use to apply NeRF to.
                </b></p>
            </div>    
        </div>
    </div>
    <div class="w3-container"style="margin-top:25px" >
        <p><b></b>
            <br>
            The architecture of my model is as follows:
            <br>
            First, I randomly sampled N = 1000 pixels for training, giving me 1000 x 2 2D coordinates as well as their 
            respective colors which have coordinates 1000 x 3 for the rgb channels. These are normalized and converted 
            into tensors in the random_sample_pixels method. Then, I implemented sinusoidal positional encoding (PE) to 
            expand the dimensionality of my randomly sampled input coordinates from 2D to a 42 dimension vector. Finally, 
            to build my MLP model, I chained together a series of nonlinear activations between layers, which includes 3 ReLU 
            opreations and then a sigmoid to clamp the values. The input dimensions I specify as 42 (which is the output of PE) and my final 
            output dimensions is 3, because I am outputing 3 dimensions of rgb to get a valid pixel color.
            <br>
            Below is a visualization of the training process of the predicted images across iterations with L = 10 (highest 
            frequency level), MSE loss function, Adam optimizer with learning rate 1e-2, batch size 10,000, trained over 3000 iterations.
        </b></p>
        <div class="w3-container" id="contact" style="display: flex; align-items: flex-end;">
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox3.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox4.png" style="width:100%" onclick="onClick(this)">
            </div>    
        </div>
        <p><b></b>
            Here are the side-by-side results.
        </p>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/fox.jpg" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Fox</div>
            </div>
            <div class="w3-half">
                <img src="./media/fox5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Fox</div>
            </div>
        </div>
        <p><b></b>
            With these hyperparameters, I achieved a PSNR of 25.96.
        </p>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/psnr_L10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training PSNR Curve L = 10</div>
                </div>
            <div class="w3-half">
                <img src="./media/loss_L10.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training Loss Curve L = 10</div>
            </div>
        </div>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <p><b></b>
            One hyperparameter I modified was the <u>max frequency L</u> for positional encoding, and 
            instead of 10 I used L = 5. We can see the striations are not as thin and the overal picture 
            is blurrier. This caused the sharpness in detail to significantly decrease 
            due to the usage of lower frequency components, and hence diminished the performance of my 
            network. With this hyperparameter modification, I achieved a lower PSNR of 24.92.
        </p>
        <div class="w3-container" id="contact" style="display: flex; align-items: flex-end;">
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/foxL5_1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/foxL5_2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/foxL5_3.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/foxL5_4.png" style="width:100%" onclick="onClick(this)">
            </div>    
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/fox.jpg" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Fox</div>
            </div>
            <div class="w3-half">
                <img src="./media/foxL5_4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Fox L = 5</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/psnr_L5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training PSNR Curve L = 5</div>
            </div>
            <div class="w3-half">
                <img src="./media/loss_L5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training Loss Curve L = 5</div>
            </div>
        </div>
        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <p><b></b>
            I also attempted to modify the <u>learning rate</u> to see how this would affect my network. By 
            using a learning rate of 1e-3 instead of 1e-2. This yielded slightly better results with a PSNR 
            of 26.12 and its curve is also much more stable. The details are slightly sharper than using a 
            learning rate of 1e-2. For example, the hairs on the top of the fox are more defined and there 
            is more contrast than in 1e-3 than 1e-2.
        <div class="w3-container" id="contact" style="display: flex; align-items: flex-end;">
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox1e-3_1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox1e-3_2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox1e-3_3.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/fox1e-3_4.png" style="width:100%" onclick="onClick(this)">
            </div>    
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/fox.jpg" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Fox</div>
            </div>
            <div class="w3-half">
                <img src="./media/fox1e-3_5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Fox LR = 1e-3</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/fox4.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Fox LR = 1e-2</div>
            </div>
            <div class="w3-half">
                <img src="./media/fox1e-3_5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Fox LR = 1e-3</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/psnr_1e-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training PSNR Curve LR = 1e-3</div>
            </div>
            <div class="w3-half">
                <img src="./media/loss_ie-3.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training Loss Curve LR = 1e-3</div>
            </div>
        </div>

        <hr style="width:50px;border:5px solid rgb(96, 125, 139)" class="w3-round">
        <p><b></b>
            Here I run the model with these hyperparameters against two different images of my own choosing: 
            L = 10, MSE loss function, Adam optimizer with learning rate 1e-3, batch size 10,000, trained over 3000 iterations. 
            The bunny computed with PSNR = 29.90 and the sunflower computed with PSNR = 23.43.
            <div class="w3-container" id="contact" style="display: flex; align-items: flex-end;">
                <div class="w3-quarter" style="margin-right: 10px;">
                    <img src="./media/bunny1.png" style="width:100%" onclick="onClick(this)">
                </div>
                <div class="w3-quarter" style="margin-right: 10px;">
                    <img src="./media/bunny2.png" style="width:100%" onclick="onClick(this)">
                </div>
                <div class="w3-quarter" style="margin-right: 10px;">
                    <img src="./media/bunny3.png" style="width:100%" onclick="onClick(this)">
                </div>
                <div class="w3-quarter" style="margin-right: 10px;">
                    <img src="./media/bunny4.png" style="width:100%" onclick="onClick(this)">
                </div>    
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-half">
                    <img src="./media/bunny.jpg" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Original Bunny</div>
                </div>
                <div class="w3-half">
                    <img src="./media/bunny5.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Reconstructed Bunny</div>
                </div>
            </div>
            <div class="w3-container" id="contact">
                <div class="w3-half">
                    <img src="./media/psnr_bunny.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Training PSNR Curve</div>
                    </div>
                <div class="w3-half">
                    <img src="./media/loss_bunny.png" style="width:100%" onclick="onClick(this)">
                    <div class="caption">Training Loss Curve</div>
                </div>
            </div>
            <div class="w3-container" id="contact" style="display: flex; align-items: flex-end;">
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/sunflower1.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/sunflower2.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/sunflower3.png" style="width:100%" onclick="onClick(this)">
            </div>
            <div class="w3-quarter" style="margin-right: 10px;">
                <img src="./media/sunflower4.png" style="width:100%" onclick="onClick(this)">
            </div>    
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/sunflower.jpg" style="width:100%" onclick="onClick(this)">
                <div class="caption">Original Sunflower</div>
            </div>
            <div class="w3-half">
                <img src="./media/sunflower5.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Reconstructed Sunflower</div>
            </div>
        </div>
        <div class="w3-container" id="contact">
            <div class="w3-half">
                <img src="./media/psnr_sunflower.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training PSNR Curve</div>
                    </div>
            <div class="w3-half">
                <img src="./media/loss_sunflower.png" style="width:100%" onclick="onClick(this)">
                <div class="caption">Training Loss Curve</div>
            </div>
        </div>
    </div>
  </div>

  <!-- Modal for full size images on click-->
  <div id="modal01" class="w3-modal w3-black" style="padding-top:0" onclick="this.style.display='none'">
    <span class="w3-button w3-black w3-xxlarge w3-display-topright">×</span>
    <div class="w3-modal-content w3-animate-zoom w3-center w3-transparent w3-padding-64">
      <img id="img01" class="w3-image">
      <p id="caption"></p>
    </div>
  </div>

<!-- End page content -->
</div>

<!-- W3.CSS Container -->
<div class="w3-light-grey w3-container w3-padding-32" style="margin-top:75px;padding-right:58px"><p class="w3-right">Website Template: <a href="https://www.w3schools.com/w3css/tryw3css_templates_interior_design.htm#services" title="W3.CSS" target="_blank" class="w3-hover-opacity">w3.css</a></p></div>

<script>
// Script to open and close sidebar
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}
 
function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}

// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}
</script>

</body>
</html>
